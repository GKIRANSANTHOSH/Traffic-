<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Smart Punishing Traffic Signal</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<style>
body{
margin:0;
font-family:Segoe UI;
color:white;
background:url("https://image2url.com/r2/default/images/1766929869850-e8b43e13-bde9-4ab9-aab2-12cdc75d477d.jpeg") center/cover fixed;
}
.overlay{
min-height:100vh;
background:rgba(0,0,0,.6);
backdrop-filter:blur(3px);
padding:30px;
}
.header{text-align:center;font-size:2.3em;font-weight:800;}
.main{
display:flex;
justify-content:space-around;
align-items:center;
flex-wrap:wrap;
margin-top:40px;
}

/* Signal */
.signal{
background:#111;
padding:30px;
border-radius:30px;
box-shadow:0 0 40px #000;
text-align:center;
}
.light{
width:90px;height:90px;border-radius:50%;margin:15px auto;
background:#333;opacity:.2;
}
.red{background:#ff3b3b;}
.yellow{background:#ffd93d;}
.green{background:#2ed573;}
.on{opacity:1;box-shadow:0 0 30px currentColor;}
#timer{font-size:3em;margin-top:15px;}

/* Meter */
.meter{
background:rgba(255,255,255,.15);
backdrop-filter:blur(8px);
padding:25px;
border-radius:25px;
text-align:center;
min-width:300px;
}
.bar{
height:25px;background:#000;border-radius:20px;overflow:hidden;margin:15px 0;
}
.fill{
height:100%;width:0;background:linear-gradient(90deg,#2ed573,#f1c40f,#ff4757);
}
#db{font-size:2.5em;}

/* Reminder */
.reminder{
background:rgba(255,0,0,.15);
border:2px solid red;
padding:20px;
border-radius:20px;
width:260px;
text-align:center;
min-height:140px;
font-weight:700;
}
</style>
</head>

<body>
<div class="overlay">
<div class="header">ðŸš¦ Smart Punishing Traffic Signal</div>

<div class="main">

<div class="signal">
<div id="r" class="light red on"></div>
<div id="y" class="light yellow"></div>
<div id="g" class="light green"></div>
<div id="timer">60</div>
</div>

<div class="meter">
<h3>Decibel Meter (Limit 50 dB)</h3>
<div id="db">-- dB</div>
<div class="bar"><div id="fill" class="fill"></div></div>
<button onclick="start()">Start Signal</button>
</div>

<div class="reminder" id="rem">
ðŸ”• Keep Silence to get Green Signal
</div>

</div>
</div>

<script>
let time=60,run=false,t;
const r=document.getElementById("r"),y=document.getElementById("y"),g=document.getElementById("g");
const dbEl=document.getElementById("db"),fill=document.getElementById("fill"),rem=document.getElementById("rem");

function lights(c){
[r,y,g].forEach(l=>l.classList.remove("on"));
c.classList.add("on");
}

function start(){
if(run)return;
run=true;time=60;
navigator.mediaDevices.getUserMedia({audio:true}).then(stream=>{
const ctx=new AudioContext();
const src=ctx.createMediaStreamSource(stream);
const an=ctx.createAnalyser();
src.connect(an);
const data=new Uint8Array(an.fftSize);

t=setInterval(()=>{
an.getByteTimeDomainData(data);
let sum=0;
for(let i=0;i<data.length;i++){
let v=(data[i]-128)/128; sum+=v*v;
}
let rms=Math.sqrt(sum/data.length);
let db=Math.round(20*Math.log10(rms*10000));
dbEl.innerText=db+" dB";
fill.style.width=Math.min(db,100)+"%";

if(db>50){
time=60;
rem.innerText="ðŸš¨ Noise Detected! Timer Reset!";
rem.style.borderColor="red";
}
else rem.innerText="ðŸŸ¢ Silence is Good";

if(time>30)lights(r);
else if(time>10)lights(y);
else lights(g);

if(time>0){time--;}
else{
rem.innerText="ðŸŽ‰ HOORAH! YOU CAN GO NOW!";
run=false;clearInterval(t);
}
document.getElementById("timer").innerText=time;
},1000);
});
}
</script>
</body>
</html>